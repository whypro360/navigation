<!-- pages/map/map.wxml -->
<!-- 地图容器 -->
<view class="container">
  <!-- 地图主体 -->
  <map 
    id="myMap"
    longitude="{{longitude}}"
    latitude="{{latitude}}"
    scale="{{scale}}"
    polylines="{{polyline}}"
    markers="{{markers}}"
    include-points="{{includePoints}}"
    bindmarkertap="handleMarkerTap"
    show-location
    class="map-container"
  ></map>
  <!-- 地图控制按钮 -->
  <view class="control-group">
    <view class="control-btn" bindtap="zoomIn">
      <image src="/images/zoom-in.png" class="control-icon"/>
    </view>
    <view class="control-btn" bindtap="zoomOut">
      <image src="/images/zoom-out.png" class="control-icon"/>
    </view>
    <view class="control-btn" bindtap="switchLayer">
      <image src="/images/layer-switch.png" class="control-icon"/>
    </view>
  </view>


    <!-- 资源类型选择 -->
  <scroll-view scroll-x class="resource-scroll" enable-flex>
    <view 
      wx:for="{{resourceTypes}}" 
      wx:key="id"
      class="resource-item {{activeTypeId === item.id ? 'active' : ''}}"
      bindtap="switchResource"
      data-id="{{item.id}}"
    >
      <image src="{{item.icon}}" class="resource-icon"/>
      <text>{{item.typeName}}</text>
    </view>
  </scroll-view>
    <!-- 搜索框 -->
  <view class="search-box">
    <input 
      placeholder="请输入搜索地点" 
      bind:tap="ToSearch" 
      class="search-input"
    />
    <image src="/images/search-icon.png" class="search-images"></image>
  </view>
</view>

<!-- 自定义导航确认弹窗 -->
<view wx:if="{{showDialog}}" class="custom-dialog-mask">
  <view class="custom-dialog">
    <!-- 弹窗标题 -->
    <text class="dialog-title">导航确认</text>
    <!-- 弹窗内容 -->
    <view class="dialog-content">
      <!-- 添加在这里↓↓↓ -->
      <view wx:if="{{selectedLocation && selectedLocation.image}}" class="location-image-container">
        <image src="{{selectedLocation.image}}" class="location-image" mode="aspectFill" />
      </view>
      <!-- 添加在这里↑↑↑ -->

      <text class="dialog-text">
        是否导航到{{selectedLocation && selectedLocation.callout.content}}？
      </text>
      <text class="location-hint">（{{selectedLocation && selectedLocation.description}}）</text>
    </view>

    <!-- 操作按钮 -->
    <view class="dialog-actions">
      <text class="btn-cancel" bindtap="cancelNavigation">取消</text>
      <text class="btn-confirm" bindtap="startNavigation">确认</text>
    </view>
  </view>
</view>